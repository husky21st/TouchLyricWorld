"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[433],{4433:function(e,t,o){o.r(t),o.d(t,{default:function(){return N}});var i=o(7294),n=o(5671),a=o(3144),r=o(4942),s=o(6841),x=o(6358),T=o(4607),u=o(1729),h=function(){function e(){(0,n.Z)(this,e)}return(0,a.Z)(e,null,[{key:"width",get:function(){return e._width}},{key:"height",get:function(){return e._height}},{key:"wr",get:function(){return e._width/100}},{key:"hr",get:function(){return e._height/100}},{key:"textScale",get:function(){return e._width/2e3}},{key:"initialize",value:function(t,o,i,n){console.log("Manager_init"),e._width=i,e._height=n,e.app=new s.Application({view:t,resolution:window.devicePixelRatio||1,backgroundColor:16317691,autoDensity:!1,antialias:!0,width:i,height:n}),x.p8.registerPlugin(T.w),T.w.registerPIXI(s),s.Loader.registerPlugin(u.r),e.app.ticker.stop(),x.p8.ticker.fps(60),x.p8.ticker.add((function(){e.app.ticker.update()})),e.app.ticker.add(e.update),e._media=o,e.ManagerInitSetting()}},{key:"ManagerInitSetting",value:function(){var e=window.navigator.userAgent.toLowerCase();console.log(e),this.isSafari=!1,-1!=e.indexOf("edge")?console.log("use Edge"):-1!=e.indexOf("chrome")?console.log("use Google Chrome"):-1!=e.indexOf("safari")?(console.log("use Safari"),this.isSafari=!0):-1!=e.indexOf("firefox")?console.log("use FireFox"):-1!=e.indexOf("opera")?console.log("use Opera"):(console.log("undefined"),this.isSafari=!0),this.isSafari&&(s.settings.PREFER_ENV=s.ENV.WEBGL)}},{key:"_onResize",value:function(t,o){e._width=t,e._height=o,e.app.renderer.resize(e.width,e.height),e.currentScene&&e.currentScene.resize(),e.app.render(),setTimeout((function(){window.scrollTo(0,1)}),200)}},{key:"changeScene",value:function(t){e.currentScene&&(console.log("Manager_destroy"),e.app.stage.removeChild(e.currentScene),e.currentScene.destroy()),e.currentScene=t,e.currentScene.alpha=0,e.app.stage.addChild(e.currentScene),x.p8.to(e.currentScene,{pixi:{alpha:1},duration:.3})}},{key:"update",value:function(){e.currentScene&&e.currentScene.update()}}]),e}();(0,r.Z)(h,"app",void 0),(0,r.Z)(h,"currentScene",void 0),(0,r.Z)(h,"_width",void 0),(0,r.Z)(h,"_height",void 0),(0,r.Z)(h,"isSafari",void 0),(0,r.Z)(h,"_media",void 0),(0,r.Z)(h,"_song",void 0);var l=o(7326),c=o(9340),v=o(6215),d=o(1120),p=JSON.parse('{"C":["0123456789","abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ",".,/`~:;\'-_=+!@#$%^&*()~{}[]<>? "],"f":["\u6a2a\u753b\u9762\u63a8\u5968\u3067\u3059","\u30d1\u30bd\u30b3\u30f3\u306e\u5834\u5408\u306f\u753b\u9762\u3092\u6a2a\u306b\u9577\u304f\u3057\u3066\u304b\u3089\u904a\u3093\u3067\u304f\u3060\u3055\u3044"]}'),y=[{name:"RocknRoll One",url:"https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap",metadata:{font:{testString:p.C.join("")+p.f.join("")}}},{name:"fontText",url:"Texts/FontPreloadingText.json"},{name:"leftMiku",url:"DancingMiku/left.png"},{name:"rightMiku",url:"DancingMiku/right.png"},{name:"centerMiku",url:"DancingMiku/center.png"}],f=o(7172);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=(0,d.Z)(e);if(t){var n=(0,d.Z)(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return(0,v.Z)(this,o)}}var B=function(e){(0,c.Z)(o,e);var t=m(o);function o(){var e;(0,n.Z)(this,o),e=t.call(this),(0,r.Z)((0,l.Z)(e),"basedWidth",1920),(0,r.Z)((0,l.Z)(e),"basedHeight",1080),(0,r.Z)((0,l.Z)(e),"PI",Math.PI);for(var i=0;i<8;i++)e.makeLine(i);return e}return(0,a.Z)(o,[{key:"makeLine",value:function(e){var t=this.basedWidth,o=(this.basedHeight,this.PI),i={width:5,color:6710886,alpha:.5,join:s.LINE_JOIN.ROUND,cap:s.LINE_CAP.ROUND};if(0===e){var n=(new s.Graphics).lineStyle(i).arc(1.05*t,.04*t,t,154.8*o/180,o);this.addChild(n)}else if(1===e){var a=(new s.Graphics).lineStyle(i).arc(.65*-t,.14*-t,t,11*o/180,37.2*o/180);this.addChild(a)}else if(2===e){var r=(new s.Graphics).lineStyle(i).arc(1.65*t,.14*-t,t,142.8*o/180,169*o/180);this.addChild(r)}else if(3===e){var x=(new s.Graphics).lineStyle(i).arc(.05*-t,.04*t,t,0,25.2*o/180);this.addChild(x)}else if(4===e){var T=(new s.Graphics).lineStyle(i).arc(.9715*t,.3515*-t,t,118*o/180,157.1*o/180);this.addChild(T)}else if(5===e){var u=(new s.Graphics).lineStyle(i).arc(.0285*t,.3515*-t,t,22.9*o/180,62*o/180);this.addChild(u)}else if(6===e){var h=(new s.Graphics).lineStyle(i).arc(.5*t,.469*-t,t,90*o/180,110.8*o/180);this.addChild(h)}else if(7===e){var l=(new s.Graphics).lineStyle(i).arc(.5*t,.469*-t,t,69.2*o/180,90*o/180);this.addChild(l)}}}]),o}(s.Container);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=(0,d.Z)(e);if(t){var n=(0,d.Z)(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return(0,v.Z)(this,o)}}function D(e){return Math.floor(Math.random()*e)}var w=function(e){(0,c.Z)(o,e);var t=g(o);function o(e){var i;(0,n.Z)(this,o),i=t.call(this),(0,r.Z)((0,l.Z)(i),"charTextBoxs",void 0),(0,r.Z)((0,l.Z)(i),"phraseTexts",void 0);for(var a,x=h.wr,T=(h.hr,h.textScale),u=[0,1,10,11,20,21,30,31,40,50,60,70,80,90],c=u.concat([2,3,12,13,22,23,32,33,41,42,51,52,61,71,81,91]),v=c.concat([4,14,24,34,43,53,62,63,64,72,73,74]),d=v.concat([65,75,82,83,84,92]),p=e.firstPhrase,y=new Array,f=0;null!==p;f++){var m=p.charCount,B=D((a=m<5?d:m<10?v:m<16?c:u).length),g=a[B];0!==f&&y[f-1]===g&&(g=a[B=D(a.length)]),y.push(g),p=p.next}console.log("placeNmbers",y),i.charTextBoxs=new Array,i.phraseTexts=new Array,p=e.firstPhrase;for(var w=0;null!==p;w++){for(var Z=p.firstChar,_=0;_<p.charCount;_++){var S=new s.Container,k=new s.Text(Z.text,{fontFamily:"Yusei Magic",fill:0,fontSize:128});k.resolution=2,k.anchor.set(.5,.55),k.scale.set(1.3*T),k.zIndex=1e4+w,S.addChild(k);var L=(new s.Graphics).beginFill(16777215).drawCircle(0,0,6*x).endFill();L.alpha=0,S.addChild(L),S.visible=!1,i.addChild(S),i.charTextBoxs.push({TextBox:S,Duration:Z.duration+50||50,Place:y[w],PhraseIndexOf:_,PhraseCharCount:p.charCount}),Z=Z.next}var R=new s.Text(p.text,{fontFamily:"Yusei Magic",fill:0,fontSize:64});R.resolution=2,R.anchor.set(.5),R.scale.set(T),R.zIndex=w,R.alpha=0,R.visible=!1,i.addChild(R),i.phraseTexts.push({TextBox:R,Duration:p.duration,NextDuration:p.next?p.next.duration:3e3}),p=p.next}return console.log("phraseTexts",i.phraseTexts),i}return o}(s.Container),Z=function(){function e(){(0,n.Z)(this,e),(0,r.Z)(this,"_MoveLyricText",void 0),this._MoveLyricText=new L}return(0,a.Z)(e,[{key:"moveCharText",value:function(e){var t=e.Place,o=e.PhraseIndexOf;0===t?o<5?this.moveTextType0(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<13?this.moveTextType7(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType3(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType5(e.TextBox,o-18,e.Duration):o<32&&this.moveTextType4(e.TextBox,o-25,e.Duration,!0):1===t?o<5?this.moveTextType0(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<13?this.moveTextType7(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType3(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType5(e.TextBox,o-18,e.Duration):o<29&&this.moveTextType6(e.TextBox,o-25,e.Duration,!0):2===t?o<5?this.moveTextType0(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType5(e.TextBox,o-9,e.Duration,!0):3===t?o<5?this.moveTextType0(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType4(e.TextBox,o-9,e.Duration,!0):4===t?o<5?this.moveTextType0(e.TextBox,o,e.Duration):o<10&&this.moveTextType1(e.TextBox,o-5,e.Duration,!0):10===t?o<5?this.moveTextType3(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<13?this.moveTextType6(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType0(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType4(e.TextBox,o-18,e.Duration):o<32&&this.moveTextType5(e.TextBox,o-25,e.Duration,!0):11===t?o<5?this.moveTextType3(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<13?this.moveTextType6(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType0(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType4(e.TextBox,o-18,e.Duration):o<29&&this.moveTextType7(e.TextBox,o-25,e.Duration,!0):12===t?o<5?this.moveTextType3(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType4(e.TextBox,o-9,e.Duration,!0):13===t?o<5?this.moveTextType3(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType5(e.TextBox,o-9,e.Duration,!0):14===t?o<5?this.moveTextType3(e.TextBox,o,e.Duration):o<10&&this.moveTextType2(e.TextBox,o-5,e.Duration,!0):20===t?o<5?this.moveTextType1(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<13?this.moveTextType7(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType3(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType5(e.TextBox,o-18,e.Duration):o<32&&this.moveTextType4(e.TextBox,o-25,e.Duration,!0):21===t?o<5?this.moveTextType1(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<13?this.moveTextType7(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType3(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType5(e.TextBox,o-18,e.Duration):o<29&&this.moveTextType6(e.TextBox,o-25,e.Duration,!0):22===t?o<5?this.moveTextType1(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType5(e.TextBox,o-9,e.Duration,!0):23===t?o<5?this.moveTextType1(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType4(e.TextBox,o-9,e.Duration,!0):24===t?o<5?this.moveTextType1(e.TextBox,o,e.Duration):o<10&&this.moveTextType0(e.TextBox,o-5,e.Duration,!0):30===t?o<5?this.moveTextType2(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<13?this.moveTextType6(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType0(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType4(e.TextBox,o-18,e.Duration):o<32&&this.moveTextType5(e.TextBox,o-25,e.Duration,!0):31===t?o<5?this.moveTextType2(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<13?this.moveTextType6(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType0(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType4(e.TextBox,o-18,e.Duration):o<29&&this.moveTextType7(e.TextBox,o-25,e.Duration,!0):32===t?o<5?this.moveTextType2(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType4(e.TextBox,o-9,e.Duration,!0):33===t?o<5?this.moveTextType2(e.TextBox,o,e.Duration):o<9?this.moveTextType7(e.TextBox,o-5,e.Duration):o<16&&this.moveTextType5(e.TextBox,o-9,e.Duration,!0):34===t?o<5?this.moveTextType2(e.TextBox,o,e.Duration):o<10&&this.moveTextType3(e.TextBox,o-5,e.Duration,!0):40===t?o<7?this.moveTextType4(e.TextBox,o,e.Duration):o<11?this.moveTextType7(e.TextBox,o-7,e.Duration,!0):o<16?this.moveTextType3(e.TextBox,o-11,e.Duration,!0):o<23?this.moveTextType5(e.TextBox,o-16,e.Duration):o<30&&this.moveTextType4(e.TextBox,o-23,e.Duration,!0):41===t?o<7?this.moveTextType4(e.TextBox,o,e.Duration):o<11?this.moveTextType7(e.TextBox,o-7,e.Duration,!0):o<16?this.moveTextType3(e.TextBox,o-11,e.Duration,!0):o<23?this.moveTextType5(e.TextBox,o-16,e.Duration):o<27&&this.moveTextType6(e.TextBox,o-23,e.Duration,!0):42===t?o<7?this.moveTextType4(e.TextBox,o,e.Duration):o<11?this.moveTextType7(e.TextBox,o-7,e.Duration,!0):o<16&&this.moveTextType2(e.TextBox,o-11,e.Duration,!0):43===t?o<7?this.moveTextType4(e.TextBox,o,e.Duration):o<14&&this.moveTextType5(e.TextBox,o-7,e.Duration,!0):50===t?o<7?this.moveTextType5(e.TextBox,o,e.Duration):o<11?this.moveTextType6(e.TextBox,o-7,e.Duration,!0):o<16?this.moveTextType0(e.TextBox,o-11,e.Duration,!0):o<23?this.moveTextType4(e.TextBox,o-16,e.Duration):o<30&&this.moveTextType5(e.TextBox,o-23,e.Duration,!0):51===t?o<7?this.moveTextType5(e.TextBox,o,e.Duration):o<11?this.moveTextType6(e.TextBox,o-7,e.Duration,!0):o<16?this.moveTextType0(e.TextBox,o-11,e.Duration,!0):o<23?this.moveTextType4(e.TextBox,o-16,e.Duration):o<27&&this.moveTextType7(e.TextBox,o-23,e.Duration,!0):52===t?o<7?this.moveTextType5(e.TextBox,o,e.Duration):o<11?this.moveTextType6(e.TextBox,o-7,e.Duration,!0):o<16&&this.moveTextType1(e.TextBox,o-11,e.Duration,!0):53===t?o<7?this.moveTextType5(e.TextBox,o,e.Duration):o<14&&this.moveTextType4(e.TextBox,o-7,e.Duration,!0):60===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration):o<8?this.moveTextType7(e.TextBox,o-4,e.Duration,!0):o<13?this.moveTextType3(e.TextBox,o-8,e.Duration,!0):o<20?this.moveTextType5(e.TextBox,o-13,e.Duration):o<24?this.moveTextType6(e.TextBox,o-20,e.Duration,!0):o<29&&this.moveTextType0(e.TextBox,o-24,e.Duration,!0):61===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration):o<8?this.moveTextType7(e.TextBox,o-4,e.Duration,!0):o<13?this.moveTextType3(e.TextBox,o-8,e.Duration,!0):o<20?this.moveTextType5(e.TextBox,o-13,e.Duration):o<27&&this.moveTextType4(e.TextBox,o-20,e.Duration,!0):62===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration):o<8?this.moveTextType7(e.TextBox,o-4,e.Duration,!0):o<13&&this.moveTextType2(e.TextBox,o-8,e.Duration,!0):63===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration):o<11&&this.moveTextType5(e.TextBox,o-4,e.Duration,!0):64===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration):o<11&&this.moveTextType4(e.TextBox,o-4,e.Duration,!0):65===t?o<5&&this.moveTextType1(e.TextBox,o,e.Duration,!0):70===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration):o<8?this.moveTextType6(e.TextBox,o-4,e.Duration,!0):o<13?this.moveTextType0(e.TextBox,o-8,e.Duration,!0):o<20?this.moveTextType4(e.TextBox,o-13,e.Duration):o<24?this.moveTextType7(e.TextBox,o-20,e.Duration,!0):o<29&&this.moveTextType3(e.TextBox,o-24,e.Duration,!0):71===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration):o<8?this.moveTextType6(e.TextBox,o-4,e.Duration,!0):o<13?this.moveTextType0(e.TextBox,o-8,e.Duration,!0):o<20?this.moveTextType4(e.TextBox,o-13,e.Duration):o<27&&this.moveTextType5(e.TextBox,o-20,e.Duration,!0):72===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration):o<8?this.moveTextType6(e.TextBox,o-4,e.Duration,!0):o<13&&this.moveTextType1(e.TextBox,o-8,e.Duration,!0):73===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration):o<11&&this.moveTextType4(e.TextBox,o-4,e.Duration,!0):74===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration):o<11&&this.moveTextType5(e.TextBox,o-4,e.Duration,!0):75===t?o<5&&this.moveTextType2(e.TextBox,o,e.Duration,!0):80===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration,!0):o<9?this.moveTextType3(e.TextBox,o-4,e.Duration,!0):o<16?this.moveTextType5(e.TextBox,o-9,e.Duration):o<20?this.moveTextType6(e.TextBox,o-16,e.Duration,!0):o<25?this.moveTextType0(e.TextBox,o-20,e.Duration,!0):o<32&&this.moveTextType4(e.TextBox,o-25,e.Duration):81===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration,!0):o<9?this.moveTextType3(e.TextBox,o-4,e.Duration,!0):o<16?this.moveTextType5(e.TextBox,o-9,e.Duration):o<23&&this.moveTextType4(e.TextBox,o-16,e.Duration,!0):82===t?o<4?this.moveTextType7(e.TextBox,o,e.Duration,!0):o<9&&this.moveTextType2(e.TextBox,o-4,e.Duration,!0):83===t?o<7&&this.moveTextType5(e.TextBox,o,e.Duration,!0):84===t?o<7&&this.moveTextType4(e.TextBox,o,e.Duration,!0):90===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration,!0):o<9?this.moveTextType0(e.TextBox,o-4,e.Duration,!0):o<16?this.moveTextType4(e.TextBox,o-9,e.Duration):o<20?this.moveTextType7(e.TextBox,o-16,e.Duration,!0):o<25?this.moveTextType3(e.TextBox,o-20,e.Duration,!0):o<32&&this.moveTextType5(e.TextBox,o-25,e.Duration):91===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration,!0):o<9?this.moveTextType0(e.TextBox,o-4,e.Duration,!0):o<16?this.moveTextType4(e.TextBox,o-9,e.Duration):o<23&&this.moveTextType5(e.TextBox,o-16,e.Duration,!0):92===t?o<4?this.moveTextType6(e.TextBox,o,e.Duration,!0):o<9&&this.moveTextType1(e.TextBox,o-4,e.Duration,!0):(console.log("%c!PhraseNumber error!","color: red"),o<5?this.moveTextType0(e.TextBox,o,e.Duration):o<9?this.moveTextType6(e.TextBox,o-5,e.Duration):o<13?this.moveTextType7(e.TextBox,o-9,e.Duration,!0):o<18?this.moveTextType3(e.TextBox,o-13,e.Duration,!0):o<25?this.moveTextType5(e.TextBox,o-18,e.Duration):o<32&&this.moveTextType4(e.TextBox,o-25,e.Duration,!0))}},{key:"moveTextType0",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(180+25.2*(5-t)/5)/180:Math.PI*(180+25.2*t/5)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:.5,y:-.05},{x:1.05,y:.04})}},{key:"moveTextType1",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(322.8+26.2*t/5)/180:Math.PI*(322.8+26.2*(5-t)/5)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:-.15,y:0},{x:-.65,y:-.14})}},{key:"moveTextType2",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(191+26.2*(5-t)/5)/180:Math.PI*(191+26.2*t/5)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:1.15,y:0},{x:1.65,y:-.14})}},{key:"moveTextType3",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(334.8+25.2*t/5)/180:Math.PI*(334.8+25.2*(5-t)/5)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:.5,y:-.05},{x:-.05,y:.04})}},{key:"moveTextType4",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(202.9+39.1*(7-t)/7)/180:Math.PI*(202.9+39.1*t/7)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:.5,y:-.05},{x:.9715,y:-.3515})}},{key:"moveTextType5",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(298+39.1*t/7)/180:Math.PI*(298+39.1*(7-t)/7)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:.5,y:-.05},{x:.0285,y:-.3515})}},{key:"moveTextType6",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(249.2+20.8*(4-t)/4)/180:Math.PI*(249.2+20.8*t/4)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:.5,y:-.05},{x:.5,y:-.469})}},{key:"moveTextType7",value:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=0;n=i?Math.PI*(270+20.8*t/4)/180:Math.PI*(270+20.8*(4-t)/4)/180,this._MoveLyricText.moveTextBasic(e,o,n,{x:.5,y:-.05},{x:.5,y:-.469})}},{key:"movePhraseText",value:function(e,t){this._MoveLyricText.movePhraseText(e,t)}}]),e}();function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=(0,d.Z)(e);if(t){var n=(0,d.Z)(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return(0,v.Z)(this,o)}}var S=function(e){(0,c.Z)(o,e);var t=_(o);function o(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;(0,n.Z)(this,o),e=t.call(this),(0,r.Z)((0,l.Z)(e),"_TestText",void 0),(0,r.Z)((0,l.Z)(e),"_LyricText",void 0),(0,r.Z)((0,l.Z)(e),"_MoveTextTypes",void 0),(0,r.Z)((0,l.Z)(e),"_TouchLine",void 0),(0,r.Z)((0,l.Z)(e),"isGameNow",void 0),(0,r.Z)((0,l.Z)(e),"fontLoaded",void 0),(0,r.Z)((0,l.Z)(e),"_player",void 0),(0,r.Z)((0,l.Z)(e),"SONGURL",void 0),(0,r.Z)((0,l.Z)(e),"charBuffer",void 0),(0,r.Z)((0,l.Z)(e),"wordBuffer",void 0),(0,r.Z)((0,l.Z)(e),"phraseBuffer",void 0),(0,r.Z)((0,l.Z)(e),"beatBuffer",void 0),(0,r.Z)((0,l.Z)(e),"beatDuration",void 0),(0,r.Z)((0,l.Z)(e),"beatLength",void 0);var a=h.wr,x=h.hr;h.textScale;e.sortableChildren=!0,e._TestText=null,e._LyricText=null,e._MoveTextTypes=new Z,e.isGameNow=!1,e.fontLoaded=!1;var T=(new s.Graphics).beginFill(0).drawRect(0,0,100*a,100*x).endFill();return T.alpha=0,T.zIndex=-10,T.interactive=!0,T.on("pointerdown",e.debug,(0,l.Z)(e)),e.addChild(T),e._TouchLine=new B,e._TouchLine.scale.set(100*a/1920,100*x/1080),e.addChild(e._TouchLine),e.SONGURL=i,e._player=new f.J5({app:{token:"Q3ofuMm4ppwyWZfn"},mediaElement:h._media,mediaBannerPosition:null,valenceArousalEnabled:!0,vocalAmplitudeEnabled:!0}),e._player.addListener({onAppReady:function(t){return e._onAppReady(t)},onVideoReady:function(t){return e._onVideoReady(t)},onTimerReady:function(t){return e._onTimerReady(t)},onPlay:function(){return e._onPlay()},onPause:function(){return e._onPause()},onTimeUpdate:function(t){return e._onTimeUpdate(t)}}),e.charBuffer=null,e.wordBuffer=null,e.phraseBuffer=null,e.beatBuffer=null,e.beatDuration=3e3,e.beatLength=4,e}return(0,a.Z)(o,[{key:"_onAppReady",value:function(e){console.log("%c!AppReady","color: aqua"),e.songUrl||(0===this.SONGURL?this._player.createFromSongUrl("https://piapro.jp/t/FDb1/20210213190029",{video:{beatId:3953882,repetitiveSegmentId:2099561,lyricId:52065,lyricDiffId:5093}}):1===this.SONGURL?this._player.createFromSongUrl("https://www.youtube.com/watch?v=pAaD4Hta0ns",{video:{beatId:3953761,repetitiveSegmentId:2099586,lyricId:52094,lyricDiffId:5171}}):2===this.SONGURL?this._player.createFromSongUrl("http://www.youtube.com/watch?v=bMtYf3R0zhY",{video:{beatId:3953902,repetitiveSegmentId:2099660,lyricId:52093,lyricDiffId:5177}}):3===this.SONGURL?this._player.createFromSongUrl("https://www.youtube.com/watch?v=Se89rQPp5tk",{video:{beatId:3953908,repetitiveSegmentId:2099661,lyricId:52061,lyricDiffId:5123}}):4===this.SONGURL?this._player.createFromSongUrl("https://www.youtube.com/watch?v=3wbZUkPxHEg",{video:{beatId:3953764,repetitiveSegmentId:2099662,lyricId:52062,lyricDiffId:5133}}):this._player.createFromSongUrl("http://www.youtube.com/watch?v=Ch4RQPG1Tmo",{video:{beatId:3953917,repetitiveSegmentId:2099665,lyricId:52063,lyricDiffId:5149}})),this._player.volume=5}},{key:"_onVideoReady",value:function(e){console.log("%c!VideoReady","color: aqua"),console.log("v",e);var t=this._player.data.getBeats()[10];this.beatDuration=t.duration,this.beatLength=t.index,console.log("beatAveData",t),this.changeStyle(),this.fontLoad(e)}},{key:"_onTimerReady",value:function(e){console.log("%c!TimerReady","color: aqua");this._player.video.firstChar.next.next,this._player.video.firstPhrase.next.next;var t=performance.now();console.log("cccc",this._player.video.findIndex(this._player.video.lastChar));var o=performance.now();console.log("cccc",this._player.video.findIndex(this._player.video.lastPhrase));var i=performance.now();console.log(o-t),console.log(i-o)}},{key:"_onPlay",value:function(){console.log("%c!Play","color: aqua"),this.isGameNow=!0}},{key:"_onPause",value:function(){console.log("%c!Pause","color: aqua"),this.isGameNow=!1}},{key:"_onTimeUpdate",value:function(e){if(this._TestText&&this._LyricText){var t=this._player.video.findPhrase(e+200);t&&t!==this.phraseBuffer&&(this.showPhrase(t),this.phraseBuffer=t);var o=this._player.video.findChar(e+1e3);o&&o!==this.charBuffer&&(this.showChar(o),this.charBuffer=o);var i=this._player.findBeat(e);i&&i!==this.beatBuffer&&(this._TestText._text2.text=i.position.toString(),this.beatBuffer=i)}}},{key:"showChar",value:function(e){if(this._LyricText){e.previous&&e.previous!==this.charBuffer&&this.showChar(e.previous),console.log("char.text",e.text);var t=this._player.video.findIndex(e),o=this._LyricText.charTextBoxs[t];this._MoveTextTypes.moveCharText(o)}}},{key:"showPhrase",value:function(e){if(this._LyricText){var t=this._player.video.findIndex(e),o=this._LyricText.phraseTexts[t];this._MoveTextTypes.movePhraseText(o,this.beatDuration)}}},{key:"_requestPlay",value:function(){this._player.requestPlay()}},{key:"debug",value:function(){console.log("%c!tap","color: red")}},{key:"changeStyle",value:function(){var e=80.8*h.wr/2;h.isSafari?h._media.style.left="".concat(e,"px"):h._media.style.transform="translate(-50%, 0%)"}},{key:"fontLoad",value:function(e){var t=this;console.log(this._player.data.text.replace(/\n/g,"")),s.Loader.shared.add({name:"Yusei Magic",url:"https://fonts.googleapis.com/css2?family=Yusei+Magic&display=swap",metadata:{font:{testString:this._player.data.text.replace(/\n/g,"")}}}),s.Loader.shared.onComplete.once((function(){return t.fontLoadEnd(e)}),this),s.Loader.shared.load()}},{key:"fontLoadEnd",value:function(e){this.fontLoaded=!0,console.log("%c!fontLoaded","color: green"),this._TestText=new k,this._TestText._text2.interactive=!0,this._TestText._text2.on("pointertap",this._requestPlay,this),this.addChild(this._TestText),this._LyricText=new w(e),this.addChild(this._LyricText)}},{key:"update",value:function(){}},{key:"resize",value:function(){}}]),o}(s.Container),k=function(e){(0,c.Z)(o,e);var t=_(o);function o(){var e;(0,n.Z)(this,o),e=t.call(this),(0,r.Z)((0,l.Z)(e),"_text2",void 0),(0,r.Z)((0,l.Z)(e),"centerLine",void 0);var i=h.wr,a=h.hr,x=h.textScale;return e._text2=new s.BitmapText("0",{fontName:"RocknRoll",tint:0,fontSize:64}),e._text2.anchor.set(.5),e._text2.position.set(10*i,90*a),e._text2.scale.set(x),e.addChild(e._text2),e.centerLine=(new s.Graphics).lineStyle(2,16711680).moveTo(50*i,0).lineTo(50*i,100*a).moveTo(0,50*a).lineTo(100*i,50*a),e.addChild(e.centerLine),e}return o}(s.Container),L=function(){function e(){(0,n.Z)(this,e),(0,r.Z)(this,"basedWidth",1920),(0,r.Z)(this,"basedHeight",1080),(0,r.Z)(this,"W",h.width),(0,r.Z)(this,"H",h.height),(0,r.Z)(this,"WtoH",h.height*this.basedWidth/this.basedHeight)}return(0,a.Z)(e,[{key:"moveTextBasic",value:function(e,t,o,i,n){e.position.set(i.x*this.W,i.y*this.WtoH);var a=x.ZP.timeline();e.visible=!0,a.to(e,{pixi:{x:(n.x+Math.cos(o))*this.W,y:(n.y-Math.sin(o))*this.WtoH},duration:.9,ease:"none"}).to(e,{pixi:{alpha:0},duration:.5,delay:t/1e3,ease:"none",onComplete:function(){e.visible=!1}})}},{key:"movePhraseText",value:function(e,t){var o=e.TextBox,i=e.Duration,n=e.NextDuration;o.position.set(.5*this.W,.38*this.H);var a=x.ZP.timeline();o.visible=!0,a.to(o,{pixi:{y:"-="+.03*this.H,alpha:1},duration:t/1e3}).to(o,{pixi:{y:"-="+.05*this.H,scale:.4,alpha:.5},duration:t/1e3,delay:(i-t)/1e3}).to(o,{pixi:{alpha:0},duration:t/1e3,delay:(n-t)/1e3,onComplete:function(){o.visible=!1}})}}]),e}();function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=(0,d.Z)(e);if(t){var n=(0,d.Z)(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return(0,v.Z)(this,o)}}var P=0,C=function(){P>0&&clearTimeout(P),P=window.setTimeout((function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);h._onResize(e,t)}),300)},M=function(e){(0,c.Z)(o,e);var t=R(o);function o(){var e;(0,n.Z)(this,o),e=t.call(this),(0,r.Z)((0,l.Z)(e),"suggestText1",void 0),(0,r.Z)((0,l.Z)(e),"suggestText2",void 0),(0,r.Z)((0,l.Z)(e),"suggestText3",void 0),(0,r.Z)((0,l.Z)(e),"continueButton",void 0);var i=h.wr,a=h.hr,T=h.textScale;return window.addEventListener("resize",C),e.suggestText1=new s.BitmapText("\u6a2a\u753b\u9762\u63a8\u5968\u3067\u3059",{fontName:"RocknRoll",tint:0,fontSize:128}),e.suggestText1.anchor.set(.5),e.suggestText1.position.set(50*i,40*a),e.suggestText1.scale.set(T),e.addChild(e.suggestText1),e.suggestText2=new s.BitmapText("please play the game in landscape mode",{fontName:"RocknRoll",tint:0,fontSize:64}),e.suggestText2.anchor.set(.5),e.suggestText2.position.set(50*i,50*a),e.suggestText2.scale.set(T),e.addChild(e.suggestText2),e.suggestText3=new s.BitmapText("\u30d1\u30bd\u30b3\u30f3\u306e\u5834\u5408\u306f\u753b\u9762\u3092\u6a2a\u306b\u9577\u304f\u3057\u3066\u304b\u3089\u904a\u3093\u3067\u304f\u3060\u3055\u3044",{fontName:"RocknRoll",tint:7368816,fontSize:72}),e.suggestText3.anchor.set(.5),e.suggestText3.position.set(50*i,60*a),e.suggestText3.scale.set(T),e.addChild(e.suggestText3),e.continueButton=new s.BitmapText("> Continue <",{fontName:"RocknRoll",tint:7368816,fontSize:64}),e.continueButton.anchor.set(.5),e.continueButton.position.set(50*i,80*a),e.continueButton.scale.set(T),e.continueButton.alpha=0,e.continueButton.interactive=!0,e.continueButton.buttonMode=!0,e.continueButton.on("pointertap",e.goGameMenuScene,(0,l.Z)(e)),e.addChild(e.continueButton),x.ZP.to(e.continueButton,{pixi:{alpha:1},duration:.2,delay:1.5}),e}return(0,a.Z)(o,[{key:"goGameMenuScene",value:function(){window.removeEventListener("resize",C),x.ZP.to(this,{pixi:{alpha:0},duration:.5,onComplete:function(){return h.changeScene(new S)}})}},{key:"update",value:function(){}},{key:"resize",value:function(){var e=h.wr,t=h.hr,o=h.textScale;this.suggestText1.position.set(50*e,37*t),this.suggestText1.scale.set(.8*o),this.suggestText2.position.set(50*e,50*t),this.suggestText2.scale.set(.8*o),this.suggestText3.position.set(50*e,60*t),this.suggestText3.scale.set(.8*o),this.continueButton.position.set(50*e,80*t),this.continueButton.scale.set(.8*o)}}]),o}(s.Container);function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=(0,d.Z)(e);if(t){var n=(0,d.Z)(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return(0,v.Z)(this,o)}}var b=function(e){(0,c.Z)(o,e);var t=I(o);function o(){var e;(0,n.Z)(this,o),e=t.call(this),(0,r.Z)((0,l.Z)(e),"_LoadingFlower",void 0),(0,r.Z)((0,l.Z)(e),"loadingText",void 0),(0,r.Z)((0,l.Z)(e),"tick",void 0),console.log("resolution",window.devicePixelRatio);var i=h.wr,a=h.hr,x=h.textScale;return e.sortableChildren=!0,e.tick=0,e.loadingText=new s.Text("Loading.",{fontFamily:"RocknRoll One",fill:0,fontSize:128}),e.loadingText.resolution=2,e.loadingText.anchor.y=.5,e.loadingText.position.set(35*i,50*a),e.loadingText.scale.set(x),e.loadingText.zIndex=100,e.addChild(e.loadingText),e._LoadingFlower=new G,e._LoadingFlower.position.set(50*i,50*a),e._LoadingFlower.scale.set(.05*i),e._LoadingFlower.alpha=.7,e.addChild(e._LoadingFlower),s.Loader.shared.add(y),s.Loader.shared.onProgress.add(e.downloadProgress,(0,l.Z)(e)),s.Loader.shared.onComplete.once(e.gameLoaded,(0,l.Z)(e)),s.Loader.shared.load(),e}return(0,a.Z)(o,[{key:"downloadProgress",value:function(e){this._LoadingFlower.flowermask.y=-5.75*e.progress}},{key:"gameLoaded",value:function(){this.initSetting(),this._LoadingFlower.flowermask.visible=!1,x.p8.to(this,{pixi:{alpha:0},duration:.5,delay:.2,onComplete:this.changeScene})}},{key:"initSetting",value:function(){s.BitmapFont.from("RocknRoll",{fontFamily:"RocknRoll One",fill:"#ffffff",fontSize:96},{resolution:2,chars:s.Loader.shared.resources.fontText.data.required.join("")+s.Loader.shared.resources.fontText.data.text.join("")})}},{key:"setAssetsVolume",value:function(){}},{key:"changeScene",value:function(){Math.max(document.documentElement.clientWidth,window.innerWidth||0)<Math.max(document.documentElement.clientHeight,window.innerHeight||0)?h.changeScene(new M):h.changeScene(new S)}},{key:"update",value:function(){this.tick+=1,90===this.tick&&(this.tick=0),this.tick<30?this.loadingText.text="Loading.":this.tick<60?this.loadingText.text="Loading..":this.loadingText.text="Loading..."}},{key:"resize",value:function(){}}]),o}(s.Container),G=function(e){(0,c.Z)(o,e);var t=I(o);function o(){var e;(0,n.Z)(this,o),e=t.call(this),(0,r.Z)((0,l.Z)(e),"flower",void 0),(0,r.Z)((0,l.Z)(e),"flowerBGSprite",void 0),(0,r.Z)((0,l.Z)(e),"flowerSprite",void 0),(0,r.Z)((0,l.Z)(e),"flowermask",void 0);h.wr,h.hr,h.textScale;return e.flower=s.Texture.from("Shapes/redTarget.png"),e.flowerSprite=s.Sprite.from(e.flower),e.addChild(e.flowerSprite),e.flowerBGSprite=s.Sprite.from(e.flower),e.addChild(e.flowerBGSprite),e.flowermask=(new s.Graphics).beginFill(0,.8).drawRect(0,0,575,575).endFill(),e.addChild(e.flowermask),e.flowermask.mask=e.flowerBGSprite,e.pivot.set(287.5,287.5),e}return o}(s.Container),F=o(5893),N=function(){var e=(0,i.useRef)(null),t=(0,i.useRef)(null);return(0,i.useEffect)((function(){var o=e.current,i=t.current;if(o&&i){var n=Math.max(document.documentElement.clientWidth,window.innerWidth||0),a=Math.max(document.documentElement.clientHeight,window.innerHeight||0);h.initialize(o,i,n,a);var r=new b;h.changeScene(r)}}),[e,t]),(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)("canvas",{ref:e}),(0,F.jsx)("div",{ref:t,id:"media"})]})}}}]);