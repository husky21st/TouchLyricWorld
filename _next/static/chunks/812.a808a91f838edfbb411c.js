"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{7812:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var o=n(7294),i=n(5671),a=n(3144),r=n(4942),l=n(6841),c=n(6358),u=n(4607),s=n(1729),d=function(){function e(){(0,i.Z)(this,e)}return(0,a.Z)(e,null,[{key:"width",get:function(){return e._width}},{key:"height",get:function(){return e._height}},{key:"wr",get:function(){return e._width/100}},{key:"hr",get:function(){return e._height/100}},{key:"textScale",get:function(){return e._width/2e3}},{key:"initialize",value:function(t,n,o,i){console.log("Manager_init"),e._width=o,e._height=i,e.app=new l.Application({view:t,resolution:window.devicePixelRatio||1,backgroundColor:16317691,autoDensity:!1,antialias:!0,width:o,height:i}),c.p8.registerPlugin(u.w),u.w.registerPIXI(l),l.Loader.registerPlugin(s.r),e.app.ticker.stop(),c.p8.ticker.fps(60),c.p8.ticker.add((function(){e.app.ticker.update()})),e.app.ticker.add(e.update),e._media=n,e.ManagerInitSetting()}},{key:"ManagerInitSetting",value:function(){var e=window.navigator.userAgent.toLowerCase();console.log(e),this.isSafari=!1,-1!=e.indexOf("edge")?console.log("use Edge"):-1!=e.indexOf("chrome")?console.log("use Google Chrome"):-1!=e.indexOf("safari")?(console.log("use Safari"),this.isSafari=!0):-1!=e.indexOf("firefox")?console.log("use FireFox"):-1!=e.indexOf("opera")?console.log("use Opera"):(console.log("undefined"),this.isSafari=!0),this.isSafari&&(l.settings.PREFER_ENV=l.ENV.WEBGL)}},{key:"_onResize",value:function(t,n){e._width=t,e._height=n,e.app.renderer.resize(e.width,e.height),e.currentScene&&e.currentScene.resize(),e.app.render(),setTimeout((function(){window.scrollTo(0,1)}),200)}},{key:"changeScene",value:function(t){e.currentScene&&(console.log("Manager_destroy"),e.app.stage.removeChild(e.currentScene),e.currentScene.destroy()),e.currentScene=t,e.currentScene.alpha=0,e.app.stage.addChild(e.currentScene),c.p8.to(e.currentScene,{pixi:{alpha:1},duration:.3})}},{key:"update",value:function(){e.currentScene&&e.currentScene.update()}}]),e}();(0,r.Z)(d,"app",void 0),(0,r.Z)(d,"currentScene",void 0),(0,r.Z)(d,"_width",void 0),(0,r.Z)(d,"_height",void 0),(0,r.Z)(d,"isSafari",void 0),(0,r.Z)(d,"_media",void 0),(0,r.Z)(d,"_song",void 0);var f=n(7326),g=n(9340),h=n(6215),p=n(1120),v=JSON.parse('{"C":["0123456789","abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ",".,/`~:;\'-_=+!@#$%^&*()~{}[]<>? "],"f":["\u6a2a\u753b\u9762\u63a8\u5968\u3067\u3059","\u30d1\u30bd\u30b3\u30f3\u306e\u5834\u5408\u306f\u753b\u9762\u3092\u6a2a\u306b\u9577\u304f\u3057\u3066\u304b\u3089\u904a\u3093\u3067\u304f\u3060\u3055\u3044"]}'),w=[{name:"RocknRoll One",url:"https://fonts.googleapis.com/css2?family=RocknRoll+One&display=swap",metadata:{font:{testString:v.C.join("")+v.f.join("")}}},{name:"fontText",url:"Texts/FontPreloadingText.json"},{name:"leftMiku",url:"DancingMiku/left.png"},{name:"rightMiku",url:"DancingMiku/right.png"},{name:"centerMiku",url:"DancingMiku/center.png"}],m=n(7172);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return(0,h.Z)(this,n)}}var y=function(e){(0,g.Z)(n,e);var t=x(n);function n(){var e;(0,i.Z)(this,n),e=t.call(this),(0,r.Z)((0,f.Z)(e),"_TestText",void 0),(0,r.Z)((0,f.Z)(e),"_player",void 0);var o=d.wr,a=d.hr;d.textScale;e.sortableChildren=!0,e._TestText=new k,e._TestText._text.interactive=!0,e._TestText._text.on("pointertap",e._requestPlay,(0,f.Z)(e)),e.addChild(e._TestText);var c=(new l.Graphics).beginFill(0).drawRect(0,0,100*o,100*a).endFill();return c.alpha=0,c.zIndex=-10,c.interactive=!0,c.on("pointertap",e.debug,(0,f.Z)(e)),e.addChild(c),e._player=new m.J5({app:{token:"Q3ofuMm4ppwyWZfn"},fontFamilies:[{key:"Yusei Magic",en:"Yusei Magic",google:!0}],mediaElement:d._media,mediaBannerPosition:null,valenceArousalEnabled:!0,vocalAmplitudeEnabled:!0}),e._player.addListener({onAppReady:function(t){return e._onAppReady(t)},onPause:function(){return e._onPause()},onPlay:function(){return e._onPlay()},onTimerReady:function(t){return e._onTimerReady(t)},onVideoReady:function(t){return e._onVideoReady(t)}}),e}return(0,a.Z)(n,[{key:"_onAppReady",value:function(e){console.log("%c!AppReady","color: aqua"),e.songUrl||this._player.createFromSongUrl("http://www.youtube.com/watch?v=Ch4RQPG1Tmo",{video:{beatId:3953917,repetitiveSegmentId:2099665,lyricId:52063,lyricDiffId:5149}}),this._player.volume=30,console.log(d._media)}},{key:"_onPause",value:function(){console.log("%c!Pause","color: aqua")}},{key:"_onPlay",value:function(){console.log("%c!Play","color: aqua")}},{key:"_onTimerReady",value:function(e){console.log("%c!TimerReady","color: aqua")}},{key:"_onVideoReady",value:function(e){console.log("%c!VideoReady","color: aqua");Math.floor(100*d.wr/15);var t=74.4*d.wr/2;d.isSafari?d._media.style.left="".concat(t,"px"):d._media.style.transform="translate(-50%, 0%)",console.log(e)}},{key:"_requestPlay",value:function(){this._player.requestPlay()}},{key:"debug",value:function(){console.log("%c!tap","color: red")}},{key:"update",value:function(){}},{key:"resize",value:function(){}}]),n}(l.Container),k=function(e){(0,g.Z)(n,e);var t=x(n);function n(){var e;(0,i.Z)(this,n),e=t.call(this),(0,r.Z)((0,f.Z)(e),"_text",void 0),(0,r.Z)((0,f.Z)(e),"centerLine",void 0);var o=d.wr,a=d.hr,c=d.textScale;return e._text=new l.BitmapText("aaa",{fontName:"RocknRoll",tint:0,fontSize:128}),e._text.anchor.set(.5),e._text.position.set(50*o,50*a),e._text.scale.set(c),e.addChild(e._text),e.centerLine=(new l.Graphics).lineStyle(2,16711680).moveTo(50*o,0).lineTo(50*o,100*a),e.addChild(e.centerLine),e}return n}(l.Container);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return(0,h.Z)(this,n)}}var Z=0,_=function(){Z>0&&clearTimeout(Z),Z=window.setTimeout((function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);d._onResize(e,t)}),300)},S=function(e){(0,g.Z)(n,e);var t=T(n);function n(){var e;(0,i.Z)(this,n),e=t.call(this),(0,r.Z)((0,f.Z)(e),"suggestText1",void 0),(0,r.Z)((0,f.Z)(e),"suggestText2",void 0),(0,r.Z)((0,f.Z)(e),"suggestText3",void 0),(0,r.Z)((0,f.Z)(e),"continueButton",void 0);var o=d.wr,a=d.hr,u=d.textScale;return window.addEventListener("resize",_),e.suggestText1=new l.BitmapText("\u6a2a\u753b\u9762\u63a8\u5968\u3067\u3059",{fontName:"RocknRoll",tint:0,fontSize:128}),e.suggestText1.anchor.set(.5),e.suggestText1.position.set(50*o,40*a),e.suggestText1.scale.set(u),e.addChild(e.suggestText1),e.suggestText2=new l.BitmapText("please play the game in landscape mode",{fontName:"RocknRoll",tint:0,fontSize:64}),e.suggestText2.anchor.set(.5),e.suggestText2.position.set(50*o,50*a),e.suggestText2.scale.set(u),e.addChild(e.suggestText2),e.suggestText3=new l.BitmapText("\u30d1\u30bd\u30b3\u30f3\u306e\u5834\u5408\u306f\u753b\u9762\u3092\u6a2a\u306b\u9577\u304f\u3057\u3066\u304b\u3089\u904a\u3093\u3067\u304f\u3060\u3055\u3044",{fontName:"RocknRoll",tint:7368816,fontSize:72}),e.suggestText3.anchor.set(.5),e.suggestText3.position.set(50*o,60*a),e.suggestText3.scale.set(u),e.addChild(e.suggestText3),e.continueButton=new l.BitmapText("> Continue <",{fontName:"RocknRoll",tint:7368816,fontSize:64}),e.continueButton.anchor.set(.5),e.continueButton.position.set(50*o,80*a),e.continueButton.scale.set(u),e.continueButton.alpha=0,e.continueButton.interactive=!0,e.continueButton.buttonMode=!0,e.continueButton.on("pointertap",e.goGameMenuScene,(0,f.Z)(e)),e.addChild(e.continueButton),c.ZP.to(e.continueButton,{pixi:{alpha:1},duration:.2,delay:1.5}),e}return(0,a.Z)(n,[{key:"goGameMenuScene",value:function(){window.removeEventListener("resize",_),c.ZP.to(this,{pixi:{alpha:0},duration:.5,onComplete:function(){return d.changeScene(new y)}})}},{key:"update",value:function(){}},{key:"resize",value:function(){var e=d.wr,t=d.hr,n=d.textScale;this.suggestText1.position.set(50*e,37*t),this.suggestText1.scale.set(.8*n),this.suggestText2.position.set(50*e,50*t),this.suggestText2.scale.set(.8*n),this.suggestText3.position.set(50*e,60*t),this.suggestText3.scale.set(.8*n),this.continueButton.position.set(50*e,80*t),this.continueButton.scale.set(.8*n)}}]),n}(l.Container);function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return(0,h.Z)(this,n)}}var C=function(e){(0,g.Z)(n,e);var t=R(n);function n(){var e;(0,i.Z)(this,n),e=t.call(this),(0,r.Z)((0,f.Z)(e),"_LoadingFlower",void 0),(0,r.Z)((0,f.Z)(e),"loadingText",void 0),(0,r.Z)((0,f.Z)(e),"tick",void 0),console.log("resolution",window.devicePixelRatio);var o=d.wr,a=d.hr,c=d.textScale;return e.sortableChildren=!0,e.tick=0,e.loadingText=new l.Text("Loading.",{fontFamily:"RocknRoll One",fill:0,fontSize:128}),e.loadingText.resolution=4,e.loadingText.anchor.y=.5,e.loadingText.position.set(35*o,50*a),e.loadingText.scale.set(c),e.loadingText.zIndex=100,e.addChild(e.loadingText),e._LoadingFlower=new B,e._LoadingFlower.position.set(50*o,50*a),e._LoadingFlower.scale.set(.05*o),e._LoadingFlower.alpha=.7,e.addChild(e._LoadingFlower),l.Loader.shared.add(w),l.Loader.shared.onProgress.add(e.downloadProgress,(0,f.Z)(e)),l.Loader.shared.onComplete.once(e.gameLoaded,(0,f.Z)(e)),l.Loader.shared.load(),e}return(0,a.Z)(n,[{key:"downloadProgress",value:function(e){this._LoadingFlower.flowermask.y=-5.75*e.progress}},{key:"gameLoaded",value:function(){this.initSetting(),this._LoadingFlower.flowermask.visible=!1,c.p8.to(this,{pixi:{alpha:0},duration:.5,delay:.2,onComplete:this.changeScene})}},{key:"initSetting",value:function(){l.BitmapFont.from("RocknRoll",{fontFamily:"RocknRoll One",fill:"#ffffff",fontSize:96},{resolution:4,chars:[l.Loader.shared.resources.fontText.data.required.join("")+l.Loader.shared.resources.fontText.data.text.join("")]})}},{key:"setAssetsVolume",value:function(){}},{key:"changeScene",value:function(){Math.max(document.documentElement.clientWidth,window.innerWidth||0)<Math.max(document.documentElement.clientHeight,window.innerHeight||0)?d.changeScene(new S):d.changeScene(new y)}},{key:"update",value:function(){this.tick+=1,90===this.tick&&(this.tick=0),this.tick<30?this.loadingText.text="Loading.":this.tick<60?this.loadingText.text="Loading..":this.loadingText.text="Loading..."}},{key:"resize",value:function(){}}]),n}(l.Container),B=function(e){(0,g.Z)(n,e);var t=R(n);function n(){var e;(0,i.Z)(this,n),e=t.call(this),(0,r.Z)((0,f.Z)(e),"flower",void 0),(0,r.Z)((0,f.Z)(e),"flowerBGSprite",void 0),(0,r.Z)((0,f.Z)(e),"flowerSprite",void 0),(0,r.Z)((0,f.Z)(e),"flowermask",void 0);d.wr,d.hr,d.textScale;return e.flower=l.Texture.from("Shapes/redTarget.png"),e.flowerSprite=l.Sprite.from(e.flower),e.addChild(e.flowerSprite),e.flowerBGSprite=l.Sprite.from(e.flower),e.addChild(e.flowerBGSprite),e.flowermask=(new l.Graphics).beginFill(0,.8).drawRect(0,0,575,575).endFill(),e.addChild(e.flowermask),e.flowermask.mask=e.flowerBGSprite,e.pivot.set(287.5,287.5),e}return n}(l.Container),L=n(5893),P=function(){var e=(0,o.useRef)(null),t=(0,o.useRef)(null);return(0,o.useEffect)((function(){var n=e.current,o=t.current;if(n&&o){var i=Math.max(document.documentElement.clientWidth,window.innerWidth||0),a=Math.max(document.documentElement.clientHeight,window.innerHeight||0);d.initialize(n,o,i,a);var r=new C;d.changeScene(r)}}),[e,t]),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("canvas",{ref:e}),(0,L.jsx)("div",{ref:t,id:"media"})]})}}}]);